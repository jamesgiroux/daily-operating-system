# v0.13.0 Version Brief

**Thesis:** Every meeting gets intelligence before you need it, the app never shows an empty state, and the surfaces that show that intelligence are clean enough to trust. A meeting looks like itself everywhere — same accent color, same time format, same entity context, same intelligence badge — whether on the daily briefing, weekly forecast, or any other surface. This version completes the event-driven intelligence lifecycle, unifies meeting rendering, closes the UX gaps that 0.12.1 left open, and ships a surface structure that matches how users actually move through their day.

**Status:** Ready to ship.

---

## Scope

### In

| ID | Title | Area |
|----|-------|------|
| I326 | Per-meeting intelligence lifecycle — detect, enrich, update, archive | Backend |
| I327 | Advance intelligence generation — weekly pipeline + polling cadence | Backend |
| I328 | Classification expansion — all meeting types get intelligence | Backend |
| I329 | Intelligence quality indicators | UX |
| I330 | Week page ±7-day meeting intelligence timeline | UX |
| I331 | Daily briefing intelligence assembly — always-live, no empty state | UX |
| I332 | Signal-triggered meeting intelligence refresh | Backend |
| I333 | Meeting intelligence collaboration — share, request input, draft agenda | UX |
| I341 | Product vocabulary — system-term strings | UX |
| I342 | Surface restructure Phase 4 | UX |
| I343 | Inline editing — field drawers replaced | UX |
| I351 | Actions chapter on PersonDetailEditorial | UX |
| I356 | Thread position UI — Replies Needed | UX |
| I358 | Email page — first-class nav surface | UX |
| I361 | Timeline meeting filtering — skip personal/focus/blocked types | Backend |
| I362 | Shared meeting card — extract core rendering from BriefingMeetingCard | UX / Component |
| I363 | Timeline data enrichment — display time + meeting type on TimelineMeeting | Backend / Types |
| I364 | Weekly forecast timeline adoption — replace MeetingRow with shared card | UX |

### Explicitly out

- Report export, PDF, SWOT (0.14.0)
- Semantic email reclassification / I357 (0.14.0)
- Signal propagation completeness (post-0.13.0 — not blocking)
- Beta hardening / I280 (pre-1.0)
- Any new integrations
- Inline expansion on the weekly timeline (daily briefing exclusive)
- UP NEXT / NOW pills on the weekly timeline (temporal state is daily-only)
- Any changes to entity detail meeting rows (MeetingRow variant="entity" stays as-is)

---

## Acceptance Criteria

Each criterion must be verified with real data in the running app. Compilation is not acceptance.

---

### I329 — Intelligence quality indicators

1. Open daily briefing. Every meeting card shows a quality badge. No badge reads "Needs Prep", "hasPrep", or any internal state name.
2. Badge vocabulary reflects the actual intelligence state: a meeting with enriched intelligence shows a different badge than one still generating.
3. The `hasPrep` dot is removed from the schedule row — it does not appear anywhere.

---

### I332 — Signal-triggered meeting intelligence refresh

1. Add a new calendar event for tomorrow with a known contact. Within the next polling cycle (≤5 min), that meeting appears in the week timeline with intelligence triggered — without manually running a refresh.
2. Receive an email from a meeting attendee. The prep for that meeting is marked stale and re-queues for enrichment on next cycle. Verify by inspecting the prep file timestamp and `intelligence_state` in the DB before and after.
3. `check_and_invalidate_preps()` is called as part of the signal processing path. Verify by adding a log line and confirming it fires when a signal arrives.

---

### I341 — Product vocabulary

Each of the following must be verified by navigating to the specific location in the running app.

| Violation | Location | Current text | Required text |
|-----------|----------|--------------|---------------|
| V-002 | `DashboardEmpty.tsx:126` | "Generate Briefing" | "Prepare my day" |
| V-003 | `MeetingDetailPage.tsx:~575` | "Meeting Intelligence Report" | "Meeting Briefing" |
| V-004 | `MeetingDetailPage.tsx:~411` | "Prep not ready yet" | "Not ready yet" or "Context building" |
| V-008 | `DailyBriefing.tsx:357` + `BriefingMeetingCard.tsx:~508` | "Read full intelligence" | "Read full briefing" |
| V-009 | `ActionsPage.tsx:64` | "proposed" (tab label) | "Suggested" |
| V-010 | `ActionsPage.tsx:~535` | "AI Suggested" | "Suggested" |
| V-032 | All three hero components | "Account Intelligence" / "Project Intelligence" / "Person Intelligence" timestamp labels | Label removed — timestamp only, no label |

---

### I342 — Surface restructure Phase 4

Full execution of the decisions in `.docs/research/i342-surface-redesign.md`. Verified surface by surface.

**Daily Briefing**

1. "Lead Story" section does not exist. The schedule section expands the next upcoming meeting inline (1-sentence context + prep status) — no separate featured meeting zone.
2. Section structure top to bottom: Day Frame → Schedule → Attention → Finis. No "Review" section. No "Priorities" section. No "Later This Week" subsection anywhere.
3. Day Frame contains: AI narrative line, capacity (hours free + meeting count), focus directive. Hero and Focus are not two separate sections.
4. Attention contains: 2-3 actions (meeting-relevant or overdue), proposed action triage (high-signal only), 3-4 urgent emails. Nothing else.
5. Key People list, Prep Grid, and entity chips do not appear on the daily briefing.

**Meeting Detail**

6. Deep Dive / Act III does not exist. Recent Wins, Open Items, Email Signals, Strategic Programs, Current State, Key Principles, Full Context, Questions to Surface — none of these sections render anywhere on the page.
7. The Appendix (all 9 sub-sections) does not exist on meeting detail. Entity-level content links to entity detail, not embedded here.
8. Only one FinisMarker renders — after Your Plan.
9. Prefill affordance is inside the Your Plan section, not the folio bar.
10. Transcript attachment CTA is in the page body, not duplicated in the folio bar.
11. "Before This Meeting" is a single merged list (readiness items + tracked actions) — not two separate sources rendered separately.

**Weekly Forecast**

12. "Open Time" / deep work blocks section does not exist.
13. "Commitments" chapter does not exist.
14. Prefill and Draft Agenda buttons do not appear on the week page.
15. Section structure: Compact week header → This Week density map (The Shape) → Meeting intelligence timeline (±7 days) → Finis. No narrative hero, no "The Three".
16. Past meetings in the timeline show outcomes, follow-ups generated, context seeds. Future meetings show intelligence quality indicator, prep gap, and days until.

**Actions**

17. Primary view organizes by upcoming meetings, not a flat list. Upcoming meetings with associated actions appear as groups ("Acme QBR · Thursday → 3 actions").
18. "Everything else" (actions with no meeting context) appears below meeting-relevant groups.
19. "Waiting" tab does not exist as a tab. "Waiting" exists only as a status badge on individual rows.
20. "All" tab does not exist.
21. Auto-expiry: a pending action that has existed for 30+ days without activity no longer appears in the Pending view.
22. FolioBar date is removed from the Actions page.
23. Search searches by title, account name, and context — not just accountId.

**Entity Detail**

24. Resolution keywords / "Matching Keywords" do not render anywhere on account, project, or person detail pages.
25. "Value Delivered" section does not exist on account detail.
26. "Portfolio Summary" section does not exist on account detail.
27. Company context appears in one location only (appendix), not in both hero and appendix.
28. "Meeting readiness callout" does not appear on entity detail pages — meeting detail owns this.
29. "Build Intelligence" button label is replaced. Acceptable labels: "Check for updates", "Refresh", or similar plain language.
30. Dead code confirmed deleted: `AppSidebar.tsx`, `WatchItem.tsx`, `ActionList.tsx`, `ActionItem.tsx`, `EmailList.tsx`. Verify with `grep -r "AppSidebar\|WatchItem\|ActionList\|ActionItem\|EmailList" src/`.

---

### I343 — Inline editing

1. Open any account detail page. Click an editable field (name, health status, notes, any custom metadata field). A drawer does not open. The field becomes editable inline.
2. Same for any project detail page.
3. `AccountFieldsDrawer` and `ProjectFieldsDrawer` do not exist anywhere in the codebase — confirm with `grep -r "AccountFieldsDrawer\|ProjectFieldsDrawer" src/`.
4. Tab and Enter keyboard navigation work within inline fields.

---

### I351 — Actions chapter on PersonDetailEditorial

1. Open the detail page for any person who has had at least one 1:1 meeting.
2. An "Actions" or equivalent chapter appears on the page — in the same structural position as actions on account and project detail pages.
3. At least one action from a 1:1 meeting with that person is surfaced there.
4. The actions chapter is absent for people with no meeting history (no empty chapter rendered).

---

### I356 — Thread position UI

1. Open daily briefing. In the Attention section, a "Replies Needed" subsection appears.
2. The threads listed are ones where the last message in the thread is from the other party (ball in your court). Verify one thread manually against Gmail to confirm it's accurate.
3. If no threads require a reply, the subsection does not render (no empty state with a heading).

---

### I358 — Email page

1. The main navigation bar includes Email as a named nav item. It is not buried in settings or accessible only via deep link.
2. Clicking it loads the email page without a full page reload.
3. The email page organizes emails by meeting or entity context — not a flat chronological list.

---

### I361 — Timeline meeting filtering

1. Open weekly forecast. No personal events appear in the timeline. Verify by checking against Google Calendar — any event classified as `personal` (dentist appointments, personal blocks, etc.) should be absent from the timeline.
2. Focus blocks and blocked time do not appear in the timeline.
3. Internal meetings, team syncs, 1:1s, all-hands, and all external meeting types continue to appear.
4. The daily briefing schedule section shows the same set of meetings (minus personal) — verify both pages show consistent results for today's meetings.

---

### I362 — Shared meeting card

1. The shared `MeetingCard` component exists at `src/components/shared/MeetingCard.tsx` with a co-located CSS module.
2. Customer/QBR/partnership/external meetings show a turmeric accent. 1:1 meetings show larkspur. Internal/team sync show linen. Verify on both the daily briefing and weekly forecast.
3. Past meetings render with muted/dimmed treatment on both pages.
4. Entity context (account or project name) appears below the meeting title on both pages.
5. Intelligence quality badges appear on both pages with the same visual treatment.
6. `BriefingMeetingCard` uses `MeetingCard` internally — it does not duplicate the base rendering. Verify: `grep -c "scheduleRow\|scheduleTime\|scheduleContent" src/components/dashboard/BriefingMeetingCard.tsx` returns 0 (those classes moved to the shared component).
7. No inline `style={{}}` props on the shared component — all styling via CSS module.

---

### I363 — Timeline data enrichment

1. Every meeting in the weekly forecast timeline displays a formatted time (e.g., "9:30 AM").
2. Meetings with a known end time display duration (e.g., "30m", "1h").
3. The time format matches the daily briefing's time display format exactly.

---

### I364 — Weekly forecast timeline adoption

1. Open the weekly forecast. The timeline chapter renders meeting cards that visually match the daily briefing's schedule section — same time format, same accent colors, same entity byline, same intelligence badges.
2. Click any meeting in the timeline. It navigates to `/meeting/$meetingId`.
3. Past meetings in the timeline show outcome indicators (checkmark + summary) — this existing behavior is preserved.
4. The "Review last meeting" link on future meetings with prior history is preserved.
5. `MeetingRow variant="timeline"` is deleted from `src/components/shared/MeetingRow.tsx`. Verify: `grep -r "variant.*timeline" src/` returns 0 results.
6. The earlier/today/ahead section structure is unchanged — only the rows inside each section are different.

---

### Design system violations (from `VIOLATIONS.md`)

Violations not covered by the issue criteria above. CRITICAL and HIGH are ship-blocking.

**CRITICAL**

31. V-001: `ActionsPage.tsx:474` — tooltip that says "Actions pending for 30+ days are automatically archived" is removed. This is a lie — no backend expiry exists yet. (Auto-expiry acceptance criteria are in I342 above; the tooltip ships only once that backend logic is verified.)

**HIGH**

32. V-007: `status-badge.tsx` — `healthStyles`, `projectStatusStyles`, `progressStyles` contain no hardcoded hex or rgba values. All color values reference CSS custom properties from `design-tokens.css`. Verify: `grep -n "rgba\|#[0-9a-f]" src/components/ui/status-badge.tsx` returns zero results inside style objects.

33. V-015: `MeetingDetailPage.tsx` — inline `style={{}}` attributes with hardcoded px values, rgba colors, and font sizes are migrated to a CSS module following the `editorial-briefing.module.css` pattern. Verify: `grep -c "style={{" src/pages/MeetingDetailPage.tsx` is materially reduced (target: ≤10 remaining instances for truly dynamic values only).

34. V-016: `ActionsPage.tsx:413` — custom "That's everything" footer replaced with `<FinisMarker />`. Verify by scrolling to the bottom of the Actions page.

**MEDIUM (fix when touching — not ship-blocking but tracked)**

35. V-030: `design-tokens.css` includes an opacity variants section defining at minimum: `--color-spice-turmeric-8`, `--color-garden-larkspur-8`, `--color-garden-larkspur-15`, `--color-garden-sage-12`, `--color-garden-sage-30`, `--color-spice-terracotta-8`. The hardcoded rgba values in V-018 through V-023 reference these tokens.

36. V-031: Margin grid pattern (`marginGrid`, `marginLabel`, `marginContent`) extracted into a shared CSS module or documented as the standard in `DESIGN-SYSTEM.md`. Other pages use the shared module, not ad-hoc layouts.

---

## Ship criteria

All acceptance criteria above are met across all 18 issues. No P0 or P1 bugs open. The daily briefing, week page, and at least one entity detail page (account, project, person) each load correctly with real data on a clean app restart. A meeting on the daily briefing and the same meeting on the weekly forecast are visually recognizable as the same entity — same accent color, same time format, same entity context, same intelligence badge.
