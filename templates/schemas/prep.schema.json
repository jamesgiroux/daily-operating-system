{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://dailyos.dev/schemas/prep.json",
  "title": "DailyOS Meeting Prep",
  "description": "Full meeting preparation document",
  "type": "object",
  "required": ["meeting_id", "title", "type"],
  "properties": {
    "meeting_id": {
      "type": "string",
      "description": "Unique identifier matching schedule"
    },
    "title": {
      "type": "string"
    },
    "time_range": {
      "type": "string",
      "description": "e.g., 9:00 AM - 9:45 AM"
    },
    "type": {
      "type": "string",
      "enum": ["customer", "internal", "personal"]
    },
    "account": {
      "type": "string"
    },
    "meeting_context": {
      "type": "string",
      "description": "Narrative context paragraph"
    },
    "quick_context": {
      "type": "object",
      "additionalProperties": { "type": "string" },
      "description": "Key-value pairs (Ring, ARR, Health, etc.)"
    },
    "attendees": {
      "type": "array",
      "items": { "$ref": "#/$defs/stakeholder" }
    },
    "since_last": {
      "type": "array",
      "items": { "type": "string" },
      "description": "What happened since last meeting"
    },
    "strategic_programs": {
      "type": "array",
      "items": { "$ref": "#/$defs/program" },
      "description": "Current strategic initiatives"
    },
    "current_state": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Current status points"
    },
    "risks": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Risks to monitor"
    },
    "talking_points": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Suggested conversation points"
    },
    "open_items": {
      "type": "array",
      "items": { "$ref": "#/$defs/actionItem" },
      "description": "Open action items to discuss"
    },
    "questions": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Questions to surface"
    },
    "key_principles": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Guiding principles for this meeting"
    },
    "references": {
      "type": "array",
      "items": { "$ref": "#/$defs/reference" },
      "description": "Source documents"
    }
  },
  "$defs": {
    "stakeholder": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": { "type": "string" },
        "role": { "type": "string" },
        "focus": { "type": "string" },
        "notes": { "type": "string" }
      }
    },
    "program": {
      "type": "object",
      "required": ["name", "status"],
      "properties": {
        "name": { "type": "string" },
        "status": {
          "type": "string",
          "enum": ["not_started", "in_progress", "completed", "blocked"]
        }
      }
    },
    "actionItem": {
      "type": "object",
      "required": ["title"],
      "properties": {
        "title": { "type": "string" },
        "due_date": { "type": "string", "format": "date" },
        "context": { "type": "string" },
        "is_overdue": { "type": "boolean", "default": false }
      }
    },
    "reference": {
      "type": "object",
      "required": ["label"],
      "properties": {
        "label": { "type": "string" },
        "path": { "type": "string" },
        "last_updated": { "type": "string" }
      }
    }
  }
}
