{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://dailyos.dev/schemas/prep.json",
  "title": "DailyOS Meeting Prep",
  "description": "Full meeting preparation document. Keys use camelCase to match Rust serde(rename_all = camelCase).",
  "type": "object",
  "required": ["meetingId", "title", "type"],
  "properties": {
    "meetingId": {
      "type": "string",
      "description": "Unique identifier matching schedule"
    },
    "calendarEventId": {
      "type": "string",
      "description": "Google Calendar event ID for cross-source matching"
    },
    "title": {
      "type": "string"
    },
    "timeRange": {
      "type": "string",
      "description": "e.g., 9:00 AM - 9:45 AM"
    },
    "type": {
      "type": "string",
      "enum": ["customer", "qbr", "training", "internal", "team_sync", "one_on_one", "partnership", "all_hands", "external", "personal"]
    },
    "account": {
      "type": "string"
    },
    "meetingContext": {
      "type": "string",
      "description": "Narrative context paragraph"
    },
    "quickContext": {
      "type": "object",
      "additionalProperties": { "type": "string" },
      "description": "Key-value pairs (Ring, ARR, Health, etc.)"
    },
    "attendees": {
      "type": "array",
      "items": { "$ref": "#/$defs/stakeholder" }
    },
    "sinceLast": {
      "type": "array",
      "items": { "type": "string" },
      "description": "What happened since last meeting"
    },
    "strategicPrograms": {
      "type": "array",
      "items": { "$ref": "#/$defs/program" },
      "description": "Current strategic initiatives"
    },
    "currentState": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Current status points"
    },
    "risks": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Risks to monitor"
    },
    "talkingPoints": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Suggested conversation points"
    },
    "openItems": {
      "type": "array",
      "items": { "$ref": "#/$defs/actionItem" },
      "description": "Open action items to discuss"
    },
    "questions": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Questions to surface"
    },
    "keyPrinciples": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Guiding principles for this meeting"
    },
    "references": {
      "type": "array",
      "items": { "$ref": "#/$defs/reference" },
      "description": "Source documents"
    }
  },
  "$defs": {
    "stakeholder": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": { "type": "string" },
        "role": { "type": "string" },
        "focus": { "type": "string" },
        "notes": { "type": "string" }
      }
    },
    "program": {
      "type": "object",
      "required": ["name", "status"],
      "properties": {
        "name": { "type": "string" },
        "status": {
          "type": "string",
          "enum": ["not_started", "in_progress", "completed", "blocked"]
        }
      }
    },
    "actionItem": {
      "type": "object",
      "required": ["title"],
      "properties": {
        "title": { "type": "string" },
        "dueDate": { "type": "string", "format": "date" },
        "context": { "type": "string" },
        "isOverdue": { "type": "boolean", "default": false }
      }
    },
    "reference": {
      "type": "object",
      "required": ["label"],
      "properties": {
        "label": { "type": "string" },
        "path": { "type": "string" },
        "lastUpdated": { "type": "string" }
      }
    }
  }
}
